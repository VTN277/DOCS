## Computing Service - EC2

### What is EC2?
- EC2 stands for Amazon Elastic Compute Cloud
- It's a service that provides virtual server resources on demand
- Key features:
  - Diverse configurations (RAM/CPU/GPU/Network bandwidth/storage)
  - Easy and quick deployment with just a few clicks
  - Almost unlimited scalability (as long as you have $$$)
  - Flexible payment options

### EC2 vs PC/Laptop
![image](https://github.com/user-attachments/assets/f7d3bbfc-43b2-46d7-9a73-80f147f845d8)

### EC2 Layer
![image](https://github.com/user-attachments/assets/56884123-11b1-4ec6-bfa9-95a1e9203520)
- EC2 is a virtual server running on AWS Hypervisor, with hardware underneath
- Users can only manage EC2 from the OS level up (Windows, Linux, etc.)
- AWS does not interfere with data from the OS level up on an EC2 instance
- EC2 instances operate as independent servers and cannot be accessed without proper permissions

### Basic EC2 Concepts
![image](https://github.com/user-attachments/assets/442035f0-adb6-4adc-bfb4-547dbafee405)
- AMI: Amazon Machine Image (similar to ISO/Ghost file containing OS information)
- EBS Volume: Virtual hard drive allocated by Amazon
- Snapshot: Point-in-time image of an EBS Volume
- Instance: Virtual server allocated with resources (CPU, RAM, GPU, etc.)

### EC2 Life Cycle (Default)
![image](https://github.com/user-attachments/assets/b0d6a128-8330-4884-b9bf-2ed8448dc899)
Basic operations:
- Launch Instance
- Reboot instance
- Stop instance
- Start Instance
- Terminate instance
- Attach/Detach Volume
- Attach/Detach IP
- Attach/Detach Security Group
- Attach/Detach IAM Role
- Create Snapshot from Volume
- Create AMI from EC2 Instance

*Note: Terminated state cannot be recovered. EBS volumes attached to the instance may or may not be deleted depending on settings.

### EC2 Life Cycle (Instance-store volume)
![image](https://github.com/user-attachments/assets/478a8d66-6550-4dad-ad74-6b42dc9f5190)
EC2 supports "instance-store" volumes:
- Directly attached to the host machine
- Data is lost when the instance stops
- Very high IOPS
- Suitable for non-critical data or high-speed cache data
- Only supports certain AMIs and Instance types
- Instances using this as root volume cannot be stopped temporarily (only launch, reboot, terminate)

### Limiting Access to EC2 Instances
![image](https://github.com/user-attachments/assets/19a5c556-fc11-41dd-bc03-7a51be7c96e7)
- AWS provides Security Groups to limit access to and from EC2 instances
- Security Group rules are stateful
- By default, outbound traffic is allowed for all
- Security Group rules only have Allow (no Deny)
- An EC2 can have multiple Security Groups

### EC2 on AWS Console
### Lab 1: Create EC2, Basic Operations
1. Create an EC2 instance from Amazon Linux 2 AMI
2. Configure security group to open SSH:22 and HTTP:80 from your IP
3. Login to the server
4. Install httpd, configure a basic website
5. Access the website
6. Create a snapshot for the root volume
7. Create an AMI from the running EC2
8. Create a new EC2 instance from the AMI
9. Access the new EC2 to check if the website is pre-installed

### Lab 2: Create EC2 Using Windows Server
1. Create an EC2 instance from Windows Server 2022 base AMI
2. Configure security group to open RDP:3389
3. Login to the server

### User-data and Meta-data
- User data: Script that runs at launch time
  - Can be used to install software, download source code/artifacts, customize settings
  - Avoid storing sensitive information in user data
- Meta data: Information loaded after EC2 boot
  - Includes public/private IP, security group, AMI-ID, Role, etc.
  - Accessible at http://169.254.169.254/latest/meta-data

### Lab 3: Using User Data and Meta Data
1. Create an EC2 instance from Amazon Linux 2 AMI
2. In the user-data section, add a script to:
   - Install httpd, configure a simple website
   - Print the instance's public and private IP by querying metadata

### EC2 Use Cases
- Lift and shift: 1:1 migration of on-premise applications
- Running basic all-in-one websites
- Compute clusters for data processing (Hadoop, Spark, etc.)
- Database servers when not using AWS's database services
- Nodes for K8S clusters

### EC2 Pricing
Pricing based on instance runtime and size. Different pricing models:
- On-Demand: Pay-as-you-go, suitable for most purposes
- Reserve Instance or Savings Plan: 1-3 year commitment for discounts (up to ~72%)
- Spot Instance: Bid for EC2 instances during low-demand periods
- Dedicated Host: Rent dedicated hardware for compliance requirements

### Elastic Block Storage (EBS)
- Block storage system
- Managed as EBS Volumes
- Only accessible when attached to an EC2 instance
- Some EBS types allow multi-attach
- Easy to increase size (but cannot decrease)

Pricing:
- Volume capacity ($/GB/Month)
- IOPS: Higher read/write speeds incur higher fees
- Snapshot storage ($/GB/Month, cheaper than volume storage)

### Common EBS Types
- General purpose (default): gp2, gp3
- IOPS Provisioned: io1, io2
- Throughput optimized HDD
- Cold HDD
- Magnetic (legacy)

### Lab 4: Add and Extend External Volume (Windows)
1. Create and attach a new volume to EC2 (Windows)
2. Login to Windows Server
3. Enable and mount volume as D:
4. Add some text files
5. Adjust volume size in AWS console
6. Extend volume using disk manager in Windows

### Lab 5: Add and Extend External Volume (Linux)
1. Create and attach a new volume to EC2 (Linux)
2. Login to Linux Server
3. Create partition and mount as /data
4. Add some text files
5. Adjust volume size in AWS console
6. Extend volume using growpart command

### Instance Classes
[Refer to Google for AWS instance classes]

### Lab: Clear Resources
1. Terminate EC2 instances
2. Delete EBS Volumes (if any remain)
3. Check and delete Elastic IP if present
4. Check and delete Snapshots if present
